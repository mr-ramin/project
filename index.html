<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>کوییز ساده</title>

<style>
    body{background:#f5f5f5;font-family:sans-serif;display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0}
    .box{background:#fff;width:100%;max-width:420px;padding:20px;border-radius:10px;border:1px solid #ddd}
    h1{text-align:center;color:#1e73be;font-size:22px;margin-bottom:20px}
    .question{background:#eef4ff;padding:12px;border-radius:8px;margin-bottom:15px;border:1px solid #cfdcff}
    .option{background:#f1f1f1;padding:10px;margin:8px 0;border-radius:8px;border:1px solid #ccc;cursor:pointer}
    .correct{background:#caffd3 !important;border-color:#28a745 !important}
    .wrong{background:#ffd4d4 !important;border-color:#d62828 !important}
    button{width:100%;background:#1e73be;color:#fff;padding:10px;border:none;border-radius:8px;font-size:15px;margin-top:12px}
    .small{background:#6c757d}
    #result{display:none;text-align:center;font-size:18px}
    .error{background:#ffd4d4;border:1px solid #d62828;padding:10px;border-radius:8px;margin-bottom:10px;display:none;text-align:center}
</style>

</head>
<body>

<div class="box">

    <div id="err" class="error"></div>

    <div id="start">
        <h1>کوییز ساده</h1>
        <button onclick="start()">شروع</button>
    </div>

    <div id="quiz" style="display:none;">
        <div id="qnum"></div>
        <div id="qtxt" class="question"></div>
        <div id="opts"></div>
        <button id="prev" class="small" onclick="prev()" style="display:none;">سوال قبلی</button>
        <button onclick="next()" id="nextbtn">سوال بعدی</button>
    </div>

    <div id="result">
        <h1>نتیجه</h1>
        <div id="score"></div>
        <button onclick="restart()">چالش مجدد</button>
    </div>

</div>


<script>
let q=[],i=0,ans=[],ok=0,no=0;

const fa = n => n.toString().replace(/[0-9]/g,d=>"۰۱۲۳۴۵۶۷۸۹"[d]);

async function start(){
    document.getElementById("start").style.display="none";
    document.getElementById("quiz").style.display="block";

    try{
        let res = await fetch("questions.json");
        let data = await res.json();

        q = data.questions.sort(()=>Math.random()-0.5).slice(0,10);
        ans = Array(10).fill(null);
        load();
    }catch{
        let e=document.getElementById("err");
        e.innerHTML="❌ خطا در بارگذاری سوالات";
        e.style.display="block";
        document.getElementById("start").style.display="block";
        document.getElementById("quiz").style.display="none";
    }
}

function load(){
    let x = q[i];

    document.getElementById("qnum").innerText = `سوال ${fa(i+1)} از ${fa(10)}`;
    document.getElementById("qtxt").innerText = x.question;

    let box = document.getElementById("opts");
    box.innerHTML="";

    x.options.forEach((t,n)=>{
        let d=document.createElement("div");
        d.className="option";
        d.innerText=t;

        if(ans[i]!==null){
            if(n===x.correct) d.classList.add("correct");
            else if(n===ans[i]) d.classList.add("wrong");
            d.style.pointerEvents="none";
        } else {
            d.onclick=()=>choose(n);
        }

        box.appendChild(d);
    });

    document.getElementById("prev").style.display = i===0 ? "none" : "block";
    document.getElementById("nextbtn").innerText = i===9 ? "پایان" : "سوال بعدی";
}

function choose(n){
    if(ans[i]!==null) return;

    ans[i]=n;
    if(n===q[i].correct) ok++;
    else no++;

    load();
}

function next(){
    if(i<9){ i++; load(); }
    else show();
}

function prev(){
    if(i>0){ i--; load(); }
}

function show(){
    document.getElementById("quiz").style.display="none";
    document.getElementById("result").style.display="block";

    document.getElementById("score").innerText=
        `✔️ درست: ${fa(ok)}   |   ❌ غلط: ${fa(no)}`;
}

function restart(){
    i=0; ok=0; no=0; ans=[];
    document.getElementById("result").style.display="none";
    start();
}
</script>

</body>
</html>
